#version 450

layout      (location = 0) in vec4 starPosition;
layout      (location = 1) in float teff;
layout      (location = 2) in float radius;

layout (location = 0) out vec4 fragColor;

layout (set = 0, binding = 0) uniform uniformBuffer {
    vec4 camera_position;
} ubo;

vec4 kelvin_table_rgb[111] = vec4[111](
    vec4(255.0/255.0,  56.0/255.0,   0.0/255.0, 1.0),
    vec4(255.0/255.0,  71.0/255.0,   0.0/255.0, 1.0),
    vec4(255.0/255.0,  83.0/255.0,   0.0/255.0, 1.0),
    vec4(255.0/255.0,  93.0/255.0,   0.0/255.0, 1.0),
    vec4(255.0/255.0, 101.0/255.0,   0.0/255.0, 1.0),
    vec4(255.0/255.0, 109.0/255.0,   0.0/255.0, 1.0),
    vec4(255.0/255.0, 115.0/255.0,   0.0/255.0, 1.0),
    vec4(255.0/255.0, 121.0/255.0,   0.0/255.0, 1.0),
    vec4(255.0/255.0, 126.0/255.0,   0.0/255.0, 1.0),
    vec4(255.0/255.0, 131.0/255.0,   0.0/255.0, 1.0),
    vec4(255.0/255.0, 138.0/255.0,  18.0/255.0, 1.0),
    vec4(255.0/255.0, 142.0/255.0,  33.0/255.0, 1.0),
    vec4(255.0/255.0, 147.0/255.0,  44.0/255.0, 1.0),
    vec4(255.0/255.0, 152.0/255.0,  54.0/255.0, 1.0),
    vec4(255.0/255.0, 157.0/255.0,  63.0/255.0, 1.0),
    vec4(255.0/255.0, 161.0/255.0,  72.0/255.0, 1.0),
    vec4(255.0/255.0, 165.0/255.0,  79.0/255.0, 1.0),
    vec4(255.0/255.0, 169.0/255.0,  87.0/255.0, 1.0),
    vec4(255.0/255.0, 173.0/255.0,  94.0/255.0, 1.0),
    vec4(255.0/255.0, 177.0/255.0, 101.0/255.0, 1.0),
    vec4(255.0/255.0, 180.0/255.0, 107.0/255.0, 1.0),
    vec4(255.0/255.0, 184.0/255.0, 114.0/255.0, 1.0),
    vec4(255.0/255.0, 187.0/255.0, 120.0/255.0, 1.0),
    vec4(255.0/255.0, 190.0/255.0, 126.0/255.0, 1.0),
    vec4(255.0/255.0, 193.0/255.0, 132.0/255.0, 1.0),
    vec4(255.0/255.0, 196.0/255.0, 137.0/255.0, 1.0),
    vec4(255.0/255.0, 199.0/255.0, 143.0/255.0, 1.0),
    vec4(255.0/255.0, 201.0/255.0, 148.0/255.0, 1.0),
    vec4(255.0/255.0, 204.0/255.0, 153.0/255.0, 1.0),
    vec4(255.0/255.0, 206.0/255.0, 159.0/255.0, 1.0),
    vec4(255.0/255.0, 209.0/255.0, 163.0/255.0, 1.0),
    vec4(255.0/255.0, 211.0/255.0, 168.0/255.0, 1.0),
    vec4(255.0/255.0, 213.0/255.0, 173.0/255.0, 1.0),
    vec4(255.0/255.0, 215.0/255.0, 177.0/255.0, 1.0),
    vec4(255.0/255.0, 217.0/255.0, 182.0/255.0, 1.0),
    vec4(255.0/255.0, 219.0/255.0, 186.0/255.0, 1.0),
    vec4(255.0/255.0, 221.0/255.0, 190.0/255.0, 1.0),
    vec4(255.0/255.0, 223.0/255.0, 194.0/255.0, 1.0),
    vec4(255.0/255.0, 225.0/255.0, 198.0/255.0, 1.0),
    vec4(255.0/255.0, 227.0/255.0, 202.0/255.0, 1.0),
    vec4(255.0/255.0, 228.0/255.0, 206.0/255.0, 1.0),
    vec4(255.0/255.0, 230.0/255.0, 210.0/255.0, 1.0),
    vec4(255.0/255.0, 232.0/255.0, 213.0/255.0, 1.0),
    vec4(255.0/255.0, 233.0/255.0, 217.0/255.0, 1.0),
    vec4(255.0/255.0, 235.0/255.0, 220.0/255.0, 1.0),
    vec4(255.0/255.0, 236.0/255.0, 224.0/255.0, 1.0),
    vec4(255.0/255.0, 238.0/255.0, 227.0/255.0, 1.0),
    vec4(255.0/255.0, 239.0/255.0, 230.0/255.0, 1.0),
    vec4(255.0/255.0, 240.0/255.0, 233.0/255.0, 1.0),
    vec4(255.0/255.0, 242.0/255.0, 236.0/255.0, 1.0),
    vec4(255.0/255.0, 243.0/255.0, 239.0/255.0, 1.0),
    vec4(255.0/255.0, 244.0/255.0, 242.0/255.0, 1.0),
    vec4(255.0/255.0, 245.0/255.0, 245.0/255.0, 1.0),
    vec4(255.0/255.0, 246.0/255.0, 247.0/255.0, 1.0),
    vec4(255.0/255.0, 248.0/255.0, 251.0/255.0, 1.0),
    vec4(255.0/255.0, 249.0/255.0, 253.0/255.0, 1.0),
    vec4(254.0/255.0, 249.0/255.0, 255.0/255.0, 1.0),
    vec4(252.0/255.0, 247.0/255.0, 255.0/255.0, 1.0),
    vec4(249.0/255.0, 246.0/255.0, 255.0/255.0, 1.0),
    vec4(247.0/255.0, 245.0/255.0, 255.0/255.0, 1.0),
    vec4(245.0/255.0, 243.0/255.0, 255.0/255.0, 1.0),
    vec4(243.0/255.0, 242.0/255.0, 255.0/255.0, 1.0),
    vec4(240.0/255.0, 241.0/255.0, 255.0/255.0, 1.0),
    vec4(239.0/255.0, 240.0/255.0, 255.0/255.0, 1.0),
    vec4(237.0/255.0, 239.0/255.0, 255.0/255.0, 1.0),
    vec4(235.0/255.0, 238.0/255.0, 255.0/255.0, 1.0),
    vec4(233.0/255.0, 237.0/255.0, 255.0/255.0, 1.0),
    vec4(231.0/255.0, 236.0/255.0, 255.0/255.0, 1.0),
    vec4(230.0/255.0, 235.0/255.0, 255.0/255.0, 1.0),
    vec4(228.0/255.0, 234.0/255.0, 255.0/255.0, 1.0),
    vec4(227.0/255.0, 233.0/255.0, 255.0/255.0, 1.0),
    vec4(225.0/255.0, 232.0/255.0, 255.0/255.0, 1.0),
    vec4(224.0/255.0, 231.0/255.0, 255.0/255.0, 1.0),
    vec4(222.0/255.0, 230.0/255.0, 255.0/255.0, 1.0),
    vec4(221.0/255.0, 230.0/255.0, 255.0/255.0, 1.0),
    vec4(220.0/255.0, 229.0/255.0, 255.0/255.0, 1.0),
    vec4(218.0/255.0, 229.0/255.0, 255.0/255.0, 1.0),
    vec4(217.0/255.0, 227.0/255.0, 255.0/255.0, 1.0),
    vec4(216.0/255.0, 227.0/255.0, 255.0/255.0, 1.0),
    vec4(215.0/255.0, 226.0/255.0, 255.0/255.0, 1.0),
    vec4(214.0/255.0, 225.0/255.0, 255.0/255.0, 1.0),
    vec4(212.0/255.0, 225.0/255.0, 255.0/255.0, 1.0),
    vec4(211.0/255.0, 224.0/255.0, 255.0/255.0, 1.0),
    vec4(210.0/255.0, 223.0/255.0, 255.0/255.0, 1.0),
    vec4(209.0/255.0, 223.0/255.0, 255.0/255.0, 1.0),
    vec4(208.0/255.0, 222.0/255.0, 255.0/255.0, 1.0),
    vec4(207.0/255.0, 221.0/255.0, 255.0/255.0, 1.0),
    vec4(207.0/255.0, 221.0/255.0, 255.0/255.0, 1.0),
    vec4(206.0/255.0, 220.0/255.0, 255.0/255.0, 1.0),
    vec4(205.0/255.0, 220.0/255.0, 255.0/255.0, 1.0),
    vec4(207.0/255.0, 218.0/255.0, 255.0/255.0, 1.0),
    vec4(207.0/255.0, 218.0/255.0, 255.0/255.0, 1.0),
    vec4(206.0/255.0, 217.0/255.0, 255.0/255.0, 1.0),
    vec4(205.0/255.0, 217.0/255.0, 255.0/255.0, 1.0),
    vec4(204.0/255.0, 216.0/255.0, 255.0/255.0, 1.0),
    vec4(204.0/255.0, 216.0/255.0, 255.0/255.0, 1.0),
    vec4(203.0/255.0, 215.0/255.0, 255.0/255.0, 1.0),
    vec4(202.0/255.0, 215.0/255.0, 255.0/255.0, 1.0),
    vec4(202.0/255.0, 214.0/255.0, 255.0/255.0, 1.0),
    vec4(201.0/255.0, 214.0/255.0, 255.0/255.0, 1.0),
    vec4(200.0/255.0, 213.0/255.0, 255.0/255.0, 1.0),
    vec4(200.0/255.0, 213.0/255.0, 255.0/255.0, 1.0),
    vec4(199.0/255.0, 212.0/255.0, 255.0/255.0, 1.0),
    vec4(198.0/255.0, 212.0/255.0, 255.0/255.0, 1.0),
    vec4(198.0/255.0, 212.0/255.0, 255.0/255.0, 1.0),
    vec4(197.0/255.0, 211.0/255.0, 255.0/255.0, 1.0),
    vec4(197.0/255.0, 211.0/255.0, 255.0/255.0, 1.0),
    vec4(197.0/255.0, 210.0/255.0, 255.0/255.0, 1.0),
    vec4(196.0/255.0, 210.0/255.0, 255.0/255.0, 1.0),
    vec4(195.0/255.0, 210.0/255.0, 255.0/255.0, 1.0),
    vec4(195.0/255.0, 209.0/255.0, 255.0/255.0, 1.0)
);

float kelvin_table_t[111] = float[111]( 1000.0, 1100.0, 1200.0, 1300.0, 1400.0, 1500.0, 1600.0, 1700.0, 1800.0, 1900.0, 2000.0, 2100.0, 2200.0, 2300.0, 2400.0, 2500.0, 2600.0, 2700.0, 2800.0, 2900.0, 3000.0, 3100.0, 3200.0, 3300.0, 3400.0, 3500.0, 3600.0, 3700.0, 3800.0, 3900.0, 4000.0, 4100.0, 4200.0, 4300.0, 4400.0, 4500.0, 4600.0, 4700.0, 4800.0, 4900.0, 5000.0, 5100.0, 5200.0, 5300.0, 5400.0, 5500.0, 5600.0, 5700.0, 5800.0, 5900.0, 6000.0, 6100.0, 6200.0, 6300.0, 6400.0, 6500.0, 6600.0, 6700.0, 6800.0, 6900.0, 7000.0, 7100.0, 7200.0, 7300.0, 7400.0, 7500.0, 7600.0, 7700.0, 7800.0, 7900.0, 8000.0, 8100.0, 8200.0, 8300.0, 8400.0, 8500.0, 8600.0, 8700.0, 8800.0, 8900.0, 9000.0, 9100.0, 9200.0, 9300.0, 9400.0, 9500.0, 9600.0, 9700.0, 9800.0, 9900.0, 1000.0, 1010.0, 1020.0, 1030.0, 1040.0, 1050.0, 1060.0, 1070.0, 1080.0, 1090.0, 1100.0, 1110.0, 1120.0, 1130.0, 1140.0, 1150.0, 1160.0, 1170.0, 1180.0, 1190.0, 1200.0 );

void main() {

    vec4 temperature_color = vec4(1.0);
    for (uint i = 0; i < 110; i++) {
        if (teff >= kelvin_table_t[i] && teff <= kelvin_table_t[i+1]) {
            temperature_color = (kelvin_table_rgb[i] + kelvin_table_rgb[i+1]) / 2.0;
            break;
        }
    }

    fragColor = temperature_color / pow(distance(ubo.camera_position, starPosition), 2) * 10.0;
}